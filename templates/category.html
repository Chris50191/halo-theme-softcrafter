<!--
    分类页面
-->
<!DOCTYPE html>
<html
  xmlns:th="https://www.thymeleaf.org"
  th:replace="~{layout :: html(header = ~{::header},content = ~{::content})}"
>
  <th:block th:fragment="header">
    <th:block
      th:if="${theme.config.patternimg.patternimg} and (${not #strings.isEmpty(category.spec.cover)} or ${not #strings.isEmpty(theme.config.patternimg.category_patternimg)}) and ${theme.config.random_image.rimage_cover_sheet_open} and ${not #strings.isEmpty(theme.config.random_image.rimage_url)}"
    >
      <div class="pattern-center-blank"></div>
      <div class="pattern-center no-select">
        <div class="pattern-attachment-img">
          <img
            th:if="${theme.config.patternimg.patternimg} and (${not #strings.isEmpty(category.spec.cover)} or ${not #strings.isEmpty(theme.config.patternimg.category_patternimg)})"
            th:attr="data-src=${not #strings.isEmpty(category.spec.cover) ? category.spec.cover : theme.config.patternimg.category_patternimg}"
            th:src="@{/assets/images/svg/loader/orange.progress-bar-stripe-loader.svg}"
            class="lazyload"
            onerror="imgError(this)"
          />
          <img
            th:unless="${theme.config.patternimg.patternimg} and (${not #strings.isEmpty(category.spec.cover)} or ${not #strings.isEmpty(theme.config.patternimg.category_patternimg)})"
            data-src='${((category.thumbnail)?length>0)?string((category.thumbnail),"${settings.category_patternimg!}")}'
            th:src="@{/assets/images/svg/loader/orange.progress-bar-stripe-loader.svg}"
            src="${settings.rimage_url!}?category=#{category.id}&type=url&itype=${settings.rimage_cover_itype!}<#if settings.rimage_cover_itype != 'image'>&id=${(settings.rimage_cover_id)!''}</#if>"
            srcset="<#if settings.rimage_cover_lqip == 'loading'>${res_base_url!}/source/images/svg/loader/orange.progress-bar-stripe-loader.svg<#else>${settings.rimage_url!}?category=#{category.id}&type=url&itype=${settings.rimage_cover_itype!}<#if settings.rimage_cover_itype != 'image'>&id=${(settings.rimage_cover_id)!''}</#if>&th=150</#if>"
            data-srcset="${settings.rimage_url!}?category=#{category.id}&type=url&itype=${settings.rimage_cover_itype!}<#if settings.rimage_cover_itype != 'image'>&id=${(settings.rimage_cover_id)!''}</#if>&th=640 640w,
                            ${settings.rimage_url!}?category=#{category.id}&type=url&itype=${settings.rimage_cover_itype!}<#if settings.rimage_cover_itype != 'image'>&id=${(settings.rimage_cover_id)!''}</#if>&th=960 960w,
                            ${settings.rimage_url!}?category=#{category.id}&type=url&itype=${settings.rimage_cover_itype!}<#if settings.rimage_cover_itype != 'image'>&id=${(settings.rimage_cover_id)!''}</#if>&th=1280 1280w,
                            ${settings.rimage_url!}?category=#{category.id}&type=url&itype=${settings.rimage_cover_itype!}<#if settings.rimage_cover_itype != 'image'>&id=${(settings.rimage_cover_id)!''}</#if> 1440w"
            data-sizes="auto"
            th:class="'lazyload '+${theme.config.random_image.rimage_cover_lqip == 'lowquality' ? 'blur-up' : ''}"
          />
        </div>
        <header class="pattern-header">
          <h1
            class="cat-title i18n"
            data-iname="page.categories.item_title"
            th:attr="data-ivalue=${category.spec.displayName}"
          ></h1>
          <span class="cat-des" th:text="${category.spec.description}"> </span>
        </header>
      </div>
    </th:block>
    <th:block>
      <div class="blank"></div>
    </th:block>
  </th:block>

  <th:block th:fragment="content">
    <div id="primary" class="content-area" th:with="postItems=${posts.items}">
      <main id="main" class="site-main" role="main">
        <th:block th:if="${posts.totalPages gt 0}">
          <!-- <#if !((settings.patternimg!true) && ((category.thumbnail?? && category.thumbnail!='') || (settings.category_patternimg?? && settings.category_patternimg!='')) || ((metas.ri?boolean)!true && settings.rimage_cover_sheet_open!true && settings.rimage_url?? && settings.rimage_url!=''))>
                <header class="page-header">
                    <h1 class="cat-title">${category.name!}</h1>
                    <span class="cat-des">
                        ${category.description!}
                    </span>
                </header>
            </#if> -->
          <th:block th:each="post : ${postItems}">
            <th:block th:replace="~{tpl/content :: content(${post})}" />
          </th:block>

          <div class="clearer"></div>
        </th:block>
        <th:block th:unless="${posts.totalPages gt 0}">
          <th:block th:replace="~{tpl/content-none}" />
        </th:block>
      </main>
      <!-- <@paginationTag method="categoryPosts" page="${posts.number}" total="${posts.totalPages}" display="3" slug="${category.slug!}">
        <#include "layouts/list-nextprev.ftl">
    </@paginationTag> -->
    </div>
  </th:block>
</html>
